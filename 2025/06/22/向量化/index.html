<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>向量化 | ao006's Blog</title><meta name="author" content="ao006"><meta name="copyright" content="ao006"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="‌向量化优化借助的是 CPU 的 SIMD 指令，即通过单条指令控制多组数据的运算。它被称为 CPU 指令级别的并行。———操作应用于整个数组或数据系列的过程，而不是逐个遍历每个元素。‌———每次处理一批数据 原理向量化优化的核心在于利用SIMD指令集。SIMD指令允许CPU在单个周期内对多个数据进行相同的操作，从而显著提高计算效率。与传统的标量指令相比，SIMD指令能够减少指令周期，减少内存访问">
<meta property="og:type" content="article">
<meta property="og:title" content="向量化">
<meta property="og:url" content="http://example.com/2025/06/22/%E5%90%91%E9%87%8F%E5%8C%96/index.html">
<meta property="og:site_name" content="ao006&#39;s Blog">
<meta property="og:description" content="‌向量化优化借助的是 CPU 的 SIMD 指令，即通过单条指令控制多组数据的运算。它被称为 CPU 指令级别的并行。———操作应用于整个数组或数据系列的过程，而不是逐个遍历每个元素。‌———每次处理一批数据 原理向量化优化的核心在于利用SIMD指令集。SIMD指令允许CPU在单个周期内对多个数据进行相同的操作，从而显著提高计算效率。与传统的标量指令相比，SIMD指令能够减少指令周期，减少内存访问">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-06-22T08:33:51.312Z">
<meta property="article:modified_time" content="2025-12-14T16:15:51.795Z">
<meta property="article:author" content="ao006">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "向量化",
  "url": "http://example.com/2025/06/22/%E5%90%91%E9%87%8F%E5%8C%96/",
  "image": "http://example.com/img/butterfly-icon.png",
  "datePublished": "2025-06-22T08:33:51.312Z",
  "dateModified": "2025-12-14T16:15:51.795Z",
  "author": [
    {
      "@type": "Person",
      "name": "ao006",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/06/22/%E5%90%91%E9%87%8F%E5%8C%96/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '向量化',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ao006's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">向量化</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">向量化</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-22T08:33:51.312Z" title="发表于 2025-06-22 16:33:51">2025-06-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-14T16:15:51.795Z" title="更新于 2025-12-15 00:15:51">2025-12-15</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>‌<strong>向量化优化</strong>借助的是 CPU 的 <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=SIMD&spm=1001.2101.3001.7020">SIMD</a> 指令，即通过单条指令控制多组数据的运算。它被称为 CPU 指令级别的并行。———操作应用于整个数组或数据系列的过程，而不是逐个遍历每个元素。‌———每次处理一批数据</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a><strong>原理</strong></h2><p>向量化优化的核心在于利用SIMD指令集。SIMD指令允许CPU在单个周期内对多个数据进行相同的操作，从而显著提高计算效率。与传统的标量指令相比，SIMD指令能够减少指令周期，减少内存访问次数，从而提升整体性能。例如，在处理大量数据时，向量化操作可以将一系列计算任务转化为对整个数组的操作指令，这些指令由底层高效的库来执行，利用硬件特性如<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=SIMD&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">SIMD</a>指令集、多核<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=CPU&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">CPU</a>&#x2F;<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=GPU&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">GPU</a>并行计算能力进行加速<br>**向量化优化的实现方法</p>
<ol>
<li>‌<strong>编译器自动向量化</strong>‌：现代编译器如<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=GCC&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">GCC</a>、<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=ICC&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">ICC</a>或<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=AOCC/LLVM&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">AOCC&#x2F;LLVM</a>等，都具备自动向量化功能。这些编译器能够识别适合向量化优化的代码段，并自动将其转换为SIMD指令‌4。——只能向量化最简单的循环</li>
<li>‌<strong>手动向量化</strong>‌：通过使用特定的<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=intrinsics&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">intrinsics</a>函数，程序员可以手动编写向量化代码。例如，在<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=Intel&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">Intel</a>平台上，可以使用<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=AVX&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">AVX</a>、<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=AVX2&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">AVX2</a>或<a target="_blank" rel="noopener" href="https://www.baidu.com/s?rsv_dl=re_dqa_generate&sa=re_dqa_generate&wd=AVX-512&rsv_pq=f4bd992b0016cfb8&oq=%E5%90%91%E9%87%8F%E5%8C%96%E4%BC%98%E5%8C%96%E5%8E%9F%E7%90%86&rsv_t=ce0aoCQLA/p6uwdFLDWDO1EDaxVsC1ZuqWJ7BodT2WSLe267klKIJsqelhA0gYP5aJkiLw&tn=84053098_3_dg&ie=utf-8">AVX-512</a>指令集的intrinsics函数来实现向量化操作</li>
</ol>
<h2 id="操作实例"><a href="#操作实例" class="headerlink" title="操作实例"></a><strong>操作实例</strong></h2><ol>
<li>基本算术运算<br> 一个具有两列的DataFrame， ‘ a ‘和’ B ‘，我们希望以元素方式添加这两列，并将结果存储在新列’ C ‘中。通过向量化，可以在一行代码中实现这一点:<br> <img src="/images/14.07.37.png"><br> 在本例中，<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=235073267&content_type=Article&match_order=1&q=%E5%8A%A0%E6%B3%95%E8%BF%90%E7%AE%97&zhida_source=entity">加法运算</a>df[‘A’] + df[‘B’]同时应用于整个列’A’和’B’，结果存储在列’C’中。</li>
<li>apply<br> 向量化还允许对列应用自定义函数。假设计算一列中每个元素的平方:<br> <img src="/images/14.08.52.png"><br> 使用.apply()将平方函数应用于整个’A’列。不需要显式循环。</li>
<li>条件操作<br> 也将<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=235073267&content_type=Article&match_order=1&q=%E7%9F%A2%E9%87%8F%E5%8C%96&zhida_source=entity">矢量化</a>用于条件操作，比如基于列a中的条件创建一个新的列D:<br> <img src="/images/14.10.42.png"><br> 使用lambda函数来检查’ a ‘中的每个元素是偶数还是奇数，并将结果分配给’ D ‘列。</li>
</ol>
<h2 id="简单实例"><a href="#简单实例" class="headerlink" title="简单实例"></a><strong>简单实例</strong></h2><ol>
<li>数组求和的并行<ul>
<li>使用一个滑动向量在原数组上滑动，每次滑动则把对应的数组部分累加到滑动向量中，滑动结束后对滑动向量进行求和。<br> <strong>串行</strong><img src="/images/13.26.56.png"><br> <strong>并行</strong><br> &#x3D;&#x3D;并行后数字累加的顺序其实改变了&#x3D;&#x3D;   ——满足结合律![[&#x2F;images&#x2F;截屏2024-11-23 12.46.51.png]]<br>（对于<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=163187502&content_type=Article&match_order=1&q=%E6%B5%AE%E7%82%B9%E6%95%B0&zhida_source=entity">浮点数</a>的累乘或者累加，由于需要rounding，所以不满足<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=163187502&content_type=Article&match_order=2&q=%E7%BB%93%E5%90%88%E5%BE%8B&zhida_source=entity">结合律</a>（结果可能不是IEEE标准compliant的），所以需要使用特殊的编译选项譬如GCC中的–ffast-math。）</li>
</ul>
<h6 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a>代码解析</h6><ol>
<li><code>sum_serial</code> 函数<ul>
<li>这是一个简单的顺序求和函数，通过遍历输入的双精度浮点数数组 <code>a</code>，将每个元素依次累加到变量 <code>sum</code> 中，最后返回累加的总和。这个函数实现了最基本的数组求和逻辑，采用单线程、顺序执行的方式完成计算任务。</li>
</ul>
</li>
<li><code>sum_vectorized</code> 函数：<ul>
<li>目的是利用向量化操作来更高效地计算数组的和。首先，通过 <code>DoubleVector.broadcast(SPECIES, 0)</code> 创建了一个初始值全为 <code>0</code> 的向量 <code>vsum</code>（这里 <code>SPECIES</code> 应该是定义了向量的某种类型相关的参数，可能表示向量的元素数量等属性，从代码上下文推测它可能是一个固定值，比如指定向量长度为 <code>4</code>）。</li>
<li>然后，使用一个循环，每次从数组 <code>a</code> 中按步长为 <code>4</code> 的方式取出一段数据（即每 <code>4</code> 个连续元素），并通过 <code>DoubleVector.fromArray(SPECIES, a, i)</code> 将这 <code>4</code> 个元素构造成一个 <code>DoubleVector</code> 类型的向量 <code>va</code>。接着，将这个新构造的向量 <code>va</code> 与之前初始化的向量 <code>vsum</code> 进行逐元素相加操作（通过 <code>vsum.add(va)</code>），循环执行这个过程，相当于分块地对数组元素进行向量形式的求和。</li>
<li>最后，通过 <code>vsum.reduceLanes​(VectorOperators.ADD)</code> 操作，将向量 <code>vsum</code> 的各个元素合并（按照加法操作）为一个标量值，也就是最终的数组元素总和，并返回这个总和。<br> ——该实现中用到了一个reduction operation即<code>vsum.reduceLanes​(VectorOperators.ADD)</code>对一个向量寄存器中的元素求和。其他的reduction包括求累乘、min、max等。<code>broadcast(SPECIES,0)</code>则是将向量所有元素初始化为0。</li>
</ul>
</li>
</ol>
<ul>
<li><img src="/images/14.01.20.png"><br>  机理：<img src="/images/14.01.55.png"><br>  进行向量化编程<img src="/images/14.02.32.png"><br>  <strong>细讲上述代码：</strong></li>
<li>include头文件arm_neon.h</li>
<li>基础数据结构——向量寄存器128-bit<br>  float32-&gt;float<br>  float64-&gt;double</li>
<li>向量vs累加中间结果，需要初始vs为0.0，采用vdupq_n_ f32</li>
<li>向量vv读取数据，采用vld1q_f32</li>
<li>向量加法： ①Intrinsic函数，采用vaddq_f32 ②编译器重载运算符</li>
<li>获取向量vs中每个向量的值vs[0]……</li>
<li>标量累计s</li>
<li>处理剩余尾部</li>
</ul>
</li>
<li>条件执行<br>&#x3D;&#x3D;如果循环中有条件执行的语句，则需要使用_mask_过滤一下。&#x3D;&#x3D;<br><strong>串行</strong><br><img src="/images/13.28.58.png"><br><strong>并行</strong><br><img src="/images/13.30.19.png"><br><code>vc.compare</code>返回一个mask，譬如 [true, true, true, false]（假设SIMD处理器是4 lanes）。<code>vc.blend(0, mask)</code>则是将<code>vc</code>中mask为true的lane设为0。对于[true, true, true, false]这样一个mask，其语义就是<code>vc[0] = 0; vc[1] = 0; vc[2] = 0; vc[3] = vc[3]</code> 。mask为true的lane就相当于被一个新的值遮住了。另外blend的第一个参数还可以是一个新的vector用来替代被遮住的lane。</li>
</ol>
<h2 id="合法性和收益"><a href="#合法性和收益" class="headerlink" title="合法性和收益"></a>合法性和收益</h2><p>&#x3D;&#x3D;向量化的合法性需要进行数据依赖分析&#x3D;&#x3D;<br>eg.<br><img src="/images/13.35.06.png"></p>
<h1 id="具体学习"><a href="#具体学习" class="headerlink" title="具体学习"></a>具体学习</h1><h1 id="内存对齐"><a href="#内存对齐" class="headerlink" title="内存对齐"></a>内存对齐</h1><p>对于局部变量，其内存地址是在编译期决定的，则若想要使首字母地址对齐，可以给编译器预编译指令—— _ _ attribute _ _ (aligned(32)))     - ( 针对gcc编译器，意为申请空间时使其32字节对齐 )</p>
<h1 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">ao006</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/06/22/%E5%90%91%E9%87%8F%E5%8C%96/">http://example.com/2025/06/22/%E5%90%91%E9%87%8F%E5%8C%96/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">ao006's Blog</a>！</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/14/hello-world/" title="Hello World"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Hello World</div></div><div class="info-2"><div class="info-item-1">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;  More info: Writing Run server1$ hexo server  More info: Server Generate static files1$ hexo generate  More info: Generating Deploy to remote sites1$ hexo deploy  More info: Deployment </div></div></div></a><a class="pagination-related" href="/2025/04/22/cuda/" title="CUDA"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">CUDA</div></div><div class="info-2"><div class="info-item-1">线程结构  kernel:在GPU上运行的特殊函数,从主机（CPU）调用Kernel时，它在GPU上启动，并在许多线程上并行运行。 grid:block的一个集合 block:每个block内部包含了许多线程 thread:每个线程是Kernel的单个执行实例。在一个block中的所有线程可以共享一些资源，并能够相互通信。 在Kernel中，可通过内置的threadIdx变量来获取其thread index。threadIdx为三维的，有相应的(x,y,z)。   一般情况下，一个kernel具有一个grid,一个grid可以有多个block,一个block可以有多个thread 索引：Thread Index：以dim3 threadIdx来表示，有threadIdx.x、threadIdx.y、threadIdx.z。Block Index：以dim3 blockIdx来表示，有blockIdx.x、blockIdx.y、blockIdx.z。Block Dimension：以dim3 blockDim来表示，有blockDim.x、blockDim.y、blockDim.z...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">ao006</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">3</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B"><span class="toc-number">2.</span> <span class="toc-text">操作实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%AE%9E%E4%BE%8B"><span class="toc-number">3.</span> <span class="toc-text">简单实例</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90"><span class="toc-number">3.1.</span> <span class="toc-text">代码解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E6%B3%95%E6%80%A7%E5%92%8C%E6%94%B6%E7%9B%8A"><span class="toc-number">4.</span> <span class="toc-text">合法性和收益</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E5%AD%A6%E4%B9%A0"><span class="toc-number">5.</span> <span class="toc-text">具体学习</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90"><span class="toc-number">6.</span> <span class="toc-text">内存对齐</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%EF%BC%9A"><span class="toc-number">7.</span> <span class="toc-text">使用：</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/14/hello-world/" title="Hello World">Hello World</a><time datetime="2025-12-13T17:44:03.604Z" title="发表于 2025-12-14 01:44:03">2025-12-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/22/%E5%90%91%E9%87%8F%E5%8C%96/" title="向量化">向量化</a><time datetime="2025-06-22T08:33:51.312Z" title="发表于 2025-06-22 16:33:51">2025-06-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/22/cuda/" title="CUDA">CUDA</a><time datetime="2025-04-22T11:27:58.260Z" title="发表于 2025-04-22 19:27:58">2025-04-22</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By ao006</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>